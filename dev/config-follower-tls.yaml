# Configuration for Follower node with TLS enabled

server:
  grpc_port: 50055
  tcp_port: 50056
  health_check_interval: 5s
  tls:
    enabled: true
    cert_file: "certs/server.crt"
    key_file: "certs/server.key"

engine:
  data_dir: "./data-follower"
  retention_period: ""
  metadata_sync_interval: 60s
  checkpoint_interval: 300s
  memtable:
    size_threshold_bytes: 4194304  # 4 MiB
    flush_interval: 1s
  sstable:
    block_size_bytes: 8192  # 8 KiB
    compression: snappy
    bloom_filter_fp_rate: 0.01
  cache:
    block_cache_capacity: 1024
  compaction:
    l0_trigger_file_count: 4
    l0_trigger_size_bytes: 16777216  # 16 MiB
    target_sstable_size_bytes: 16777216  # 16 MiB
    levels_size_multiplier: 5
    max_levels: 7
    check_interval: 120s
    fallback_strategy: PickOldest
    tombstone_weight: 1.5
    overlap_penalty_weight: 1.0
    intra_l0_trigger_file_count: 8
    intra_l0_max_file_size_bytes: 2097152  # 2 MiB
  wal:
    sync_mode: interval
    batch_size: 1
    flush_interval: 1000ms
    max_segment_size_bytes: 33554432  # 32 MiB
    purge_keep_segments: 4
  index:
    memtable_threshold: 10000
    flush_interval: 60s
    compaction_check_interval: 20s
    l0_trigger_file_count: 4
    base_target_size_bytes: 2097152  # 2 MiB

logging:
  level: info
  output: stdout
  file: nexusbase-follower.log

security:
  enabled: false
  user_file_path: users.db

self_monitoring:
  enabled: true
  interval: 15s
  metric_prefix: "__"
  leader_address: "localhost:50051"  # Send self-monitoring metrics to leader

query_server:
  enabled: true
  listen_address: ":8089"

tracing:
  enabled: false
  endpoint: "localhost:4317"
  protocol: grpc

debug:
  enabled: true
  listen_address: "0.0.0.0:6061"
  pprof_enabled: true
  metrics_enabled: true
  monitor_ui_enabled: true

replication:
  mode: follower
  listen_address: ":50054"
  followers: []
  leader_address: "localhost:50053"
  tls:
    enabled: true
    cert_file: "certs/replication.crt"
    key_file: "certs/replication.key"
  graceful_stop_timeout_seconds: 30
